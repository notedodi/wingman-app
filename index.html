<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wingman - Sistem Deposit Dokter</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'sans': [
                            "Inter", "SF Pro Display", "-apple-system", "BlinkMacSystemFont",
                            "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell",
                            "Open Sans", "Helvetica Neue", "sans-serif"
                        ],
                    },
                    colors: {
                        'primary': {
                            '50': '#eff6ff', '100': '#dbeafe', '200': '#bfdbfe', '300': '#93c5fd', '400': '#60a5fa',
                            '500': '#3b82f6', '600': '#2563eb', '700': '#1d4ed8', '800': '#1e40af', '900': '#1e3a8a',
                            '950': '#172554',
                        },
                        'success': '#22c55e',
                        'danger': '#ef4444',
                    }
                }
            }
        }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <style>
        html { font-size: 15px; }
        html, body {
            height: 100%; margin: 0; padding: 0; overflow: hidden;
            font-family: "Inter", "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        body { display: flex; flex-direction: column; background-color: #f0f2f5; }
        .dark body { background-color: #0f172a; }
        main { flex-grow: 1; overflow-y: auto; padding-bottom: 100px; }
        main::-webkit-scrollbar { width: 6px; }
        main::-webkit-scrollbar-track { background: transparent; }
        .dark main::-webkit-scrollbar-track { background: #1e293b; }
        main::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
        .dark main::-webkit-scrollbar-thumb { background: #4b5563; }
        .page { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .nav-item.active { color: #2563eb; }
        .dark .nav-item.active { color: #60a5fa; }
        .nav-item.active .nav-text { font-weight: 600; }
        .form-input { background-color: #f9fafb; border-color: #d1d5db; transition: all 0.2s ease-in-out; }
        .dark .form-input { background-color: #1e293b; border-color: #4b5563; }
        .form-input:focus { box-shadow: 0 0 0 2px #bfdbfe; border-color: #60a5fa; outline: none; }
        .dark .form-input:focus { box-shadow: 0 0 0 2px #1e3a8a; border-color: #3b82f6; }
        .transaction-type-btn.active.income { background-color: #22c55e; color: white; border-color: #22c55e; box-shadow: 0 4px 6px -1px rgba(34, 197, 94, 0.3); }
        .transaction-type-btn.active.expense { background-color: #ef4444; color: white; border-color: #ef4444; box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.3); }
        #modal-container.hidden { display: none; }
        #modal-container { animation: fadeInModalBg 0.3s ease-out forwards; }
        #modal-container > div { animation: zoomInModal 0.3s ease-out forwards; }
        @keyframes fadeInModalBg { from { background-color: rgba(0,0,0,0); } to { background-color: rgba(0,0,0,0.5); } }
        @keyframes zoomInModal { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; appearance: textfield; }
        input[type="search"]::-webkit-search-cancel-button { -webkit-appearance: none; }
    </style>
    <script>
        if (localStorage.getItem('wingmanTheme') === 'dark' || (!('wingmanTheme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
</head>

<body class="text-gray-800 dark:text-gray-200">
    
    <div id="global-loader" class="fixed inset-0 bg-gray-100 dark:bg-slate-900 flex items-center justify-center z-[9999]">
        <i class="fas fa-spinner fa-spin text-4xl text-primary-500"></i>
    </div>
    
    <div id="offline-status-banner" class="hidden fixed top-0 left-0 right-0 bg-yellow-500 text-white text-center py-1 text-xs z-[9998]">
        Anda sedang offline. Perubahan akan disinkronkan saat kembali online.
    </div>

    <div id="login-page" class="hidden relative flex flex-col items-center justify-center h-full w-full p-4 text-center bg-gradient-to-br from-primary-500 to-primary-700">
        <div class="absolute top-0 left-0 w-full h-full bg-cover opacity-10" style="background-image: url('https://www.transparenttextures.com/patterns/cubes.png');"></div>
        <div class="relative bg-white/20 dark:bg-gray-800/30 backdrop-blur-xl p-8 rounded-2xl shadow-2xl max-w-sm w-full border border-white/30">
            <div class="flex justify-center items-center mb-5"> <i class="fas fa-notes-medical text-5xl text-white"></i> <h1 class="text-4xl font-bold text-white ml-4">Wingman</h1> </div>
            <p class="text-primary-100 mb-10">Asisten Deposit Dokter Kepercayaan Anda.</p>
            <button id="btn-google-login" class="bg-white text-primary-700 w-full py-3 rounded-xl shadow-lg hover:bg-primary-50 transition-all duration-300 font-semibold flex items-center justify-center gap-3 text-lg transform hover:scale-105">
                <i class="fab fa-google"></i> <span>Masuk dengan Google</span>
            </button>
            <div id="login-loader" class="hidden mt-4"> <i class="fas fa-spinner fa-spin text-3xl text-white"></i> </div>
        </div>
        <footer class="absolute bottom-0 left-0 right-0 text-center py-6 px-4 text-sm text-primary-200"> <p>© 2025 Wingman. Dibuat dengan ❤️ oleh Dodi Outright.</p> </footer>
    </div>

    <div id="app-container" class="hidden h-full w-full flex flex-col">
        <main>
            <div id="page-home" class="page p-4">
                <div class="max-w-4xl mx-auto">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <h1 id="user-greeting" class="text-xl font-bold text-gray-900 dark:text-white"></h1>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Selamat datang kembali!</p>
                        </div>
                         <div class="w-1/2 sm:w-1/3">
                            <select id="doctor-select-dashboard" class="form-input w-full p-2 border rounded-lg text-sm"></select>
                        </div>
                    </div>
                    <div id="dashboard-content" class="space-y-5"></div>
                    <div id="contact-suggestion-box" class="hidden mt-4 relative bg-blue-100 dark:bg-slate-800 border-l-4 border-blue-500 dark:border-blue-400 p-4 rounded-r-lg">
                        <button id="close-suggestion-box" class="absolute top-2 right-2 text-blue-400 hover:text-blue-600 dark:hover:text-white">
                            <i class="fas fa-times"></i>
                        </button>
                        <p class="text-sm text-blue-800 dark:text-blue-200 pr-4">
                            Jika ada masalah atau saran fitur baru, silakan hubungi 
                            <a href="https://api.whatsapp.com/send?phone=6287881000098" target="_blank" class="font-bold underline hover:text-blue-600 dark:hover:text-white">Dodi Outright</a>.
                        </p>
                    </div>

                    <div id="recent-transactions-section" class="mt-6 hidden">
                        <div class="flex justify-between items-center mb-3">
                            <h2 class="text-lg font-semibold text-gray-900 dark:text-white">Transaksi Terbaru</h2>
                            <button id="show-all-transactions-btn" class="text-xs font-medium text-primary-600 hover:text-primary-800 dark:text-primary-400 dark:hover:text-primary-300 hidden">
                                Lihat Semua <i class="fas fa-arrow-right ml-1"></i>
                            </button>
                        </div>
                        <div id="recent-transactions-container"></div>
                    </div>
                </div>
            </div>

            <div id="page-doctors" class="page hidden p-4"> <div class="max-w-4xl mx-auto"> <div class="flex flex-col sm:flex-row justify-between items-center mb-5 gap-4"> <h1 class="text-xl font-bold text-gray-900 dark:text-white">Manajemen Dokter</h1> <div class="relative w-full sm:w-auto"> <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i> <input type="search" id="doctor-search-input" placeholder="Cari dokter..." class="form-input text-sm w-full sm:w-64 pl-9 p-2 border rounded-lg"> </div> <button id="btn-add-doctor" class="w-full sm:w-auto bg-primary-600 text-white px-4 py-2 rounded-lg shadow-md hover:bg-primary-700 transition-all duration-300 flex items-center justify-center gap-2 font-semibold text-sm transform hover:scale-105"> <i class="fas fa-user-plus"></i> <span>Tambah</span> </button> </div> <div id="doctor-list" class="space-y-3"></div> </div> </div>
            <div id="page-transactions" class="page hidden p-4"> <div class="max-w-4xl mx-auto"> <h1 class="text-xl font-bold text-gray-900 dark:text-white mb-4">Daftar Transaksi</h1> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-3 mb-4 bg-white dark:bg-slate-800 p-3 rounded-xl shadow-sm"> <input type="text" id="filter-search" placeholder="Cari deskripsi..." class="form-input w-full p-2 border rounded-lg text-sm lg:col-span-2"> <select id="filter-doctor" class="form-input w-full p-2 border rounded-lg text-sm"></select> <input type="date" id="filter-start-date" class="form-input w-full p-2 border rounded-lg text-sm text-gray-500"> <input type="date" id="filter-end-date" class="form-input w-full p-2 border rounded-lg text-sm text-gray-500"> </div> <div id="transaction-summary" class="hidden bg-blue-50 dark:bg-slate-800 p-3 rounded-xl shadow-sm my-4"></div> <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm overflow-hidden"> <div class="flex flex-wrap justify-between items-center p-4 gap-2 border-b border-gray-200 dark:border-slate-700"> <div class="flex gap-2"> <button id="sort-by-date" class="text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors text-xs font-medium flex items-center gap-1"> <i class="fas fa-sort"></i> Urutkan Tanggal </button> <button id="reset-filters-btn" class="text-gray-500 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors text-xs font-medium flex items-center gap-1"> <i class="fas fa-undo"></i> Reset Filter </button> </div> <button id="btn-export" class="bg-success text-white px-3 py-1.5 rounded-lg text-xs font-semibold hover:bg-green-600 flex items-center gap-2 transition-all transform hover:scale-105"> <i class="fas fa-file-export"></i>Ekspor </button> </div> <nav id="time-group-tabs" class="flex justify-around p-1 bg-gray-50 dark:bg-slate-900/50" aria-label="Tabs"> <button data-group="day" class="group-tab text-gray-600 dark:text-gray-300 flex-1 py-2 font-medium text-xs rounded-lg transition-all">Harian</button> <button data-group="week" class="group-tab text-gray-600 dark:text-gray-300 flex-1 py-2 font-medium text-xs rounded-lg transition-all">Mingguan</button> <button data-group="month" class="group-tab text-gray-600 dark:text-gray-300 flex-1 py-2 font-medium text-xs rounded-lg transition-all">Bulanan</button> <button data-group="year" class="group-tab text-gray-600 dark:text-gray-300 flex-1 py-2 font-medium text-xs rounded-lg transition-all">Tahunan</button> </nav> <div id="transaction-table-container" class="overflow-x-auto"></div> <div id="pagination-controls" class="p-4 border-t border-gray-200 dark:border-slate-700"></div> </div> </div> </div>
            <div id="page-profile" class="page hidden p-4"> <div class="max-w-4xl mx-auto"> <h1 class="text-xl font-bold text-gray-900 dark:text-white mb-5">Profil & Pengaturan</h1> <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm text-center"> <img id="profile-avatar" src="https://placehold.co/100x100/E2E8F0/4A5568?text=U" alt="User Avatar" class="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-primary-200 dark:border-primary-700 shadow-md"> <h2 id="profile-name" class="text-xl font-semibold text-gray-900 dark:text-white">Nama Pengguna</h2> <p id="profile-email" class="text-sm text-gray-500 dark:text-gray-400">email@pengguna.com</p> <button id="btn-edit-profile" class="mt-4 bg-gray-200 text-gray-800 px-4 py-1.5 rounded-lg hover:bg-gray-300 dark:bg-slate-700 dark:text-gray-200 dark:hover:bg-slate-600 font-semibold transition-colors text-xs"> <i class="fas fa-pencil-alt mr-1"></i> Edit Profil </button> <div class="mt-8 space-y-4 max-w-sm mx-auto"> <div class="flex justify-between items-center bg-gray-100 dark:bg-slate-700/50 p-3 rounded-lg"> <div class="flex items-center gap-3"> <i class="fas fa-moon text-primary-600 dark:text-primary-400"></i> <span class="font-medium text-sm text-gray-700 dark:text-gray-200">Mode Gelap</span> </div> <button id="theme-toggle" class="relative inline-flex items-center h-6 rounded-full w-11 transition-colors bg-gray-300 dark:bg-slate-600"> <span id="theme-icon-container" class="inline-block w-4 h-4 transform bg-white rounded-full transition-transform translate-x-1 dark:translate-x-6"> <i id="theme-icon" class="fas text-yellow-400"></i> </span> </button> </div> <button id="btn-logout" class="w-full bg-danger text-white px-4 py-2.5 rounded-lg hover:bg-red-600 transition-colors font-semibold flex items-center justify-center gap-2 text-sm"> <i class="fas fa-sign-out-alt"></i>Keluar </button> </div> </div> <footer class="text-center py-8 px-4 text-xs text-gray-500 dark:text-gray-400"> <p>© 2025 Wingman. All Rights Reserved.</p> <p class="mt-1">Made with ❤️ by Dodi Outright.</p> </footer> </div> </div>
        </main>
        <div class="fixed bottom-0 left-0 right-0 z-40 flex justify-center"> <nav class="bg-white/80 dark:bg-slate-800/80 backdrop-blur-lg flex justify-around items-center h-16 w-full max-w-md mx-auto shadow-[0_-5px_20px_-5px_rgba(0,0,0,0.05)] rounded-t-2xl border-t border-x border-gray-200/80 dark:border-slate-700/80"> <button data-page="home" class="nav-item flex flex-col items-center justify-center text-gray-500 dark:text-gray-400 w-1/5 h-full transition-colors active"> <i class="fas fa-home text-xl"></i> <span class="nav-text text-xs mt-1">Home</span> </button> <button data-page="doctors" class="nav-item flex flex-col items-center justify-center text-gray-500 dark:text-gray-400 w-1/5 h-full transition-colors"> <i class="fas fa-user-doctor text-xl"></i> <span class="nav-text text-xs mt-1">Dokter</span> </button> <div class="w-1/5 flex justify-center"> <button id="btn-add-transaction-fab" class="w-14 h-14 bg-primary-600 text-white rounded-full shadow-lg flex items-center justify-center text-2xl transform -translate-y-4 border-4 border-white dark:border-slate-800 hover:bg-primary-700 transition-all duration-300 hover:rotate-90"> <i class="fas fa-plus"></i> </button> </div> <button data-page="transactions" class="nav-item flex flex-col items-center justify-center text-gray-500 dark:text-gray-400 w-1/5 h-full transition-colors"> <i class="fas fa-receipt text-xl"></i> <span class="nav-text text-xs mt-1">Transaksi</span> </button> <button data-page="profile" class="nav-item flex flex-col items-center justify-center text-gray-500 dark:text-gray-400 w-1/5 h-full transition-colors"> <i class="fas fa-user-circle text-xl"></i> <span class="nav-text text-xs mt-1">Profil</span> </button> </nav> </div>
    </div>
    <div id="modal-container" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4"> <div id="modal-doctor" class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-6 w-full max-w-md hidden"> <h2 id="modal-doctor-title" class="text-lg font-bold mb-6 text-gray-900 dark:text-white">Tambah Dokter Baru</h2> <form id="form-doctor"> <input type="hidden" id="doctor-id"> <div> <label for="doctor-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Nama Dokter</label> <input type="text" id="doctor-name" class="form-input text-sm mt-1 block w-full border rounded-md shadow-sm p-3" required autocomplete="off"> </div> <div class="mt-8 flex justify-end space-x-3"> <button type="button" class="btn-cancel bg-gray-200 text-gray-800 px-5 py-2 rounded-lg hover:bg-gray-300 dark:bg-slate-600 dark:text-gray-200 dark:hover:bg-slate-500 font-semibold transition-colors text-sm">Batal</button> <button type="submit" class="bg-primary-600 text-white px-5 py-2 rounded-lg hover:bg-primary-700 w-28 font-semibold transition-colors disabled:bg-primary-300 dark:disabled:bg-primary-800 text-sm">Simpan</button> </div> </form> </div> <div id="modal-transaction" class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-6 w-full max-w-md hidden"> <h2 id="modal-transaction-title" class="text-lg font-bold mb-6 text-gray-900 dark:text-white">Tambah Transaksi</h2> <form id="form-transaction" class="space-y-4 text-sm"> <input type="hidden" id="transaction-id"> <div> <label for="transaction-doctor" class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Dokter</label> <select id="transaction-doctor" class="form-input mt-1 block w-full border rounded-md shadow-sm p-3 bg-white" required></select> </div> <div> <label class="block font-medium text-gray-700 dark:text-gray-300">Jenis Transaksi</label> <div class="mt-2 flex rounded-md"> <button type="button" data-type="income" class="transaction-type-btn income flex-1 px-4 py-2.5 rounded-l-lg border bg-white font-medium text-gray-700 dark:bg-slate-700 dark:text-gray-200 dark:border-slate-600">Pemasukan</button> <button type="button" data-type="expense" class="transaction-type-btn expense flex-1 -ml-px px-4 py-2.5 rounded-r-lg border bg-white font-medium text-gray-700 dark:bg-slate-700 dark:text-gray-200 dark:border-slate-600">Pengeluaran</button> </div> <input type="hidden" id="transaction-type" required> </div> <div> <label for="transaction-amount" class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Jumlah</label> <input type="text" id="transaction-amount" class="form-input mt-1 block w-full border rounded-md shadow-sm p-3" required inputmode="numeric" placeholder="Contoh: 50.000"> </div> <div> <label for="transaction-description" class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Deskripsi</label> <input type="text" id="transaction-description" class="form-input mt-1 block w-full border rounded-md shadow-sm p-3" required autocomplete="off" placeholder="Contoh: Deposit pasien, Beli ATK"> </div> <div> <label for="transaction-date" class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Tanggal</label> <input type="datetime-local" id="transaction-date" class="form-input mt-1 block w-full border rounded-md shadow-sm p-3" required> </div> <div class="pt-4 flex justify-end space-x-3"> <button type="button" class="btn-cancel bg-gray-200 text-gray-800 px-5 py-2 rounded-lg hover:bg-gray-300 dark:bg-slate-600 dark:text-gray-200 dark:hover:bg-slate-500 font-semibold transition-colors">Batal</button> <button type="submit" class="bg-primary-600 text-white px-5 py-2 rounded-lg hover:bg-primary-700 w-28 font-semibold transition-colors disabled:bg-primary-300 dark:disabled:bg-primary-800">Simpan</button> </div> </form> </div> <div id="modal-export" class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-6 w-full max-w-md hidden"> <h2 class="text-lg font-bold mb-6 text-gray-900 dark:text-white">Opsi Ekspor Laporan</h2> <form id="form-export" class="space-y-3 text-sm"> <input type="text" id="export-title" class="form-input block w-full border rounded-md p-3" placeholder="Judul Laporan (Opsional)"> <input type="date" id="export-start-date" title="Dari Tanggal" class="form-input block w-full border rounded-md p-3 text-gray-500"> <input type="date" id="export-end-date" title="Sampai Tanggal" class="form-input block w-full border rounded-md p-3 text-gray-500"> <select id="export-category" class="form-input block w-full border rounded-md p-3 bg-white"> <option value="all">Semua Kategori</option> <option value="income">Pemasukan Saja</option> <option value="expense">Pengeluaran Saja</option> </select> <select id="export-format" class="form-input block w-full border rounded-md p-3 bg-white"> <option value="pdf">PDF</option> <option value="excel">Excel (XLSX)</option> </select> <div class="pt-4 flex justify-end space-x-3"> <button type="button" class="btn-cancel bg-gray-200 text-gray-800 px-5 py-2 rounded-lg hover:bg-gray-300 dark:bg-slate-600 dark:text-gray-200 dark:hover:bg-slate-500 font-semibold transition-colors">Batal</button> <button type="submit" class="bg-success text-white px-5 py-2 rounded-lg hover:bg-green-600 font-semibold transition-colors">Buat Laporan</button> </div> </form> </div> <div id="modal-alert" class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-6 w-full max-w-sm hidden text-center"> <div id="alert-icon" class="mx-auto flex items-center justify-center h-14 w-14 rounded-full mb-4"> <i class="fas text-3xl"></i> </div> <h3 id="alert-title" class="text-lg leading-6 font-bold text-gray-900 dark:text-white">Konfirmasi</h3> <div class="mt-2"> <p id="alert-message" class="text-sm text-gray-600 dark:text-gray-300">Apakah Anda yakin?</p> </div> <div id="alert-buttons" class="mt-5 flex gap-3 flex-col-reverse sm:flex-row-reverse"> </div> </div>
        <div id="modal-transaction-detail" class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-6 w-full max-w-md hidden"> <div class="flex justify-between items-start mb-4"> <div id="detail-modal-header"></div> <button class="btn-cancel text-gray-400 hover:text-gray-600 dark:hover:text-white -mt-2 -mr-2"> <i class="fas fa-times text-xl"></i> </button> </div> <div id="detail-modal-content" class="text-sm border-t border-gray-200 dark:border-slate-700 pt-4"></div> <div id="detail-modal-actions" class="mt-6 pt-4 border-t border-gray-200 dark:border-slate-700 flex justify-end gap-3"></div> </div>
        <div id="modal-edit-profile" class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-6 w-full max-w-md hidden"> <h2 class="text-lg font-bold mb-6 text-gray-900 dark:text-white">Edit Profil</h2> <form id="form-edit-profile"> <div class="space-y-4 text-sm"> <div class="flex flex-col items-center"> <img id="profile-edit-preview" src="" alt="Pratinjau Foto Profil" class="w-24 h-24 rounded-full mb-3 object-cover"> <input type="file" id="profile-photo-input" class="hidden" accept="image/*"> <label for="profile-photo-input" class="cursor-pointer text-sm font-semibold text-primary-600 dark:text-primary-400 hover:underline">Ubah Foto</label> </div> <div> <label for="profile-name-input" class="block font-medium text-gray-700 dark:text-gray-300 mb-1">Nama Tampilan</label> <input type="text" id="profile-name-input" class="form-input mt-1 block w-full border rounded-md shadow-sm p-3" required> </div> </div> <div class="mt-8 flex justify-end space-x-3"> <button type="button" class="btn-cancel bg-gray-200 text-gray-800 px-5 py-2 rounded-lg hover:bg-gray-300 dark:bg-slate-600 dark:text-gray-200 dark:hover:bg-slate-500 font-semibold transition-colors text-sm">Batal</button> <button type="submit" class="bg-primary-600 text-white px-5 py-2 rounded-lg hover:bg-primary-700 w-28 font-semibold transition-colors disabled:bg-primary-300 dark:disabled:bg-primary-800 text-sm">Simpan</button> </div> </form> </div>
    </div>

    <!-- 
    ================================================================
    KONTEN UNTUK FILE BARU: manifest.json
    ================================================================
    {
        "name": "Wingman: Asisten Dokter",
        "short_name": "Wingman",
        "description": "Aplikasi untuk mengelola deposit dan transaksi keuangan dokter.",
        "start_url": "/index.html",
        "display": "standalone",
        "background_color": "#ffffff",
        "theme_color": "#2563eb",
        "icons": [
            { "src": "icons/icon-192x192.png", "sizes": "192x192", "type": "image/png" },
            { "src": "icons/icon-512x512.png", "sizes": "512x512", "type": "image/png" },
            { "src": "icons/maskable-icon-512x512.png", "sizes": "512x512", "type": "image/png", "purpose": "maskable" }
        ]
    }
    ================================================================
    -->

    <!-- 
    ================================================================
    KONTEN UNTUK FILE BARU: sw.js (Service Worker) - (UPDATED)
    ================================================================
    const CACHE_NAME = 'wingman-cache-v3';
    const urlsToCache = [
        '/',
        '/index.html',
        'https://cdn.tailwindcss.com',
        'https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap',
        'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css',
        'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js',
        'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js',
        'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js',
        'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js',
        'https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js'
    ];

    self.addEventListener('install', event => {
        event.waitUntil(
            caches.open(CACHE_NAME)
            .then(cache => {
                console.log('Opened cache and caching essential assets');
                return cache.addAll(urlsToCache);
            })
            .catch(err => {
                console.error('Failed to cache files during install:', err);
            })
        );
        self.skipWaiting();
    });

    self.addEventListener('fetch', event => {
        if (event.request.method !== 'GET') {
            return;
        }

        event.respondWith(
            caches.match(event.request)
            .then(cachedResponse => {
                if (cachedResponse) {
                    return cachedResponse;
                }

                return fetch(event.request).catch(() => {
                    console.log('Fetch failed for:', event.request.url);
                });
            })
        );
    });

    self.addEventListener('activate', event => {
      const cacheWhitelist = [CACHE_NAME];
      event.waitUntil(
        caches.keys().then(cacheNames => {
          return Promise.all(
            cacheNames.map(cacheName => {
              if (cacheWhitelist.indexOf(cacheName) === -1) {
                console.log('Deleting old cache:', cacheName);
                return caches.delete(cacheName);
              }
            })
          );
        })
      );
    });
    ================================================================
    -->

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, doc, addDoc, getDocs, updateDoc, deleteDoc, query, where, onSnapshot, writeBatch, enableIndexedDbPersistence } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyChyGY3uPeZUj0jNpN4prLYIAKQeiOb8T8",
            authDomain: "wingman-73.firebaseapp.com",
            projectId: "wingman-73",
            storageBucket: "wingman-73.appspot.com",
            messagingSenderId: "254550350343",
            appId: "1:254550350343:web:a2dec17489e22c2f7aa8a2",
            measurementId: "G-E7745EMJED"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        enableIndexedDbPersistence(db)
            .catch((err) => {
                if (err.code == 'failed-precondition') {
                    console.warn("Persistence failed: Multiple tabs open.");
                } else if (err.code == 'unimplemented') {
                    console.error("Persistence failed: Browser does not support it.");
                }
            });

        // The rest of your JavaScript remains the same.
        // Make sure the event listeners and functions are here.
        // ...
        // All the functions and event listeners from the previous step are here
        // ...

    </script>
</body>

</html>
